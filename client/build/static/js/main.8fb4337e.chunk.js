(this.webpackJsonpghost_climber=this.webpackJsonpghost_climber||[]).push([[0],{190:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(67),o=a.n(c),l=(a(77),a(20)),s=a(2),i=a(9),u=function(){var e=Object(n.useState)(!1),t=Object(i.a)(e,2),a=t[0],c=t[1];return r.a.createElement("nav",{className:"flex bg-gray-100 p-3 flex-wrap border-b border-b-2 border-gray-200"},r.a.createElement(l.b,{to:"/",className:"p-2 mr-4 inline-flex items-center border-r-2"},r.a.createElement("i",{className:"fas fa-ghost fa-2x mx-2"}),r.a.createElement("span",{className:"text-xl text-gray font-bold uppercase tracking-wide"},"Ghost Climbers")),r.a.createElement("div",{className:"md:hidden inline-flex flex-row ml-auto "},r.a.createElement("button",{className:"text-gray p-3 hover:bg-gray-300 rounded hover:text-gray outline-none",onClick:function(){return c(!a)}},r.a.createElement("i",{className:"fas fa-bars"}))),r.a.createElement("div",{className:"".concat(a?"block":"hidden","  top-navbar w-full md:inline-flex  md:flex-grow md:w-auto pt-2"),id:"navigation"},r.a.createElement("div",{className:"md:inline-flex md:flex-row md:ml-auto md:w-auto w-full md:items-center items-start  flex flex-col md:h-auto"},[{name:"Inicio",h_ref:"/",id:"1"},{name:"Iniciar Sesi\xf3n",h_ref:"#!",id:"3"}].map((function(e){return r.a.createElement(l.b,{key:e.id,to:e.h_ref,className:"md:inline-flex md:w-auto w-full px-3 py-2 rounded text-gray items-center justify-center hover:bg-gray-300 hover:text-gray"},r.a.createElement("span",null,e.name))})))))},d=Object(n.createContext)(),m=Object(n.createContext)(),f=function(e){var t=e.sb,a=Object(n.useState)(0),c=Object(i.a)(a,2),o=c[0],l=c[1],s=Object(n.useState)(0),u=Object(i.a)(s,2),d=u[0],f=u[1],b=Object(n.useContext)(m),p=b.addContador,E=b.setThisContador;return Object(n.useEffect)((function(){t&&f(E(t._id))}),[t,E]),r.a.createElement("div",{id:"",className:"relative flex pr-3 items-center justify-center"},r.a.createElement("button",{className:" inline-block flex justify-center items-center rounded w-12 px-3 focus:outline-none ' \n          ".concat(0===d.contador&&0===o?"bg-blue-200 text-gray-500":"bg-blue-500 text-white","\n            "),onClick:function(){if(o<=2){l(o+1);var e={subsector:{_id:t._id},contador:1,fecha:Date.now()};p(e,d._id)}}},d&&r.a.createElement("h5",{className:""},d.contador),r.a.createElement("i",{className:"fas fa-ghost ml-1"})),o>0?r.a.createElement("button",{className:"relative inset-y-0 inline-block bg-transparent focus:outline-none flex justify-center items-center text-sm  text-gray-500",onClick:function(){l(0);var e={subsector:{_id:t._id},contador:-o,fecha:Date.now()};p(e,d._id)}},r.a.createElement("i",{className:"fas fa-undo ml-3 "})):"")},b=function(e){var t=e.sb;return r.a.createElement("div",null,r.a.createElement("div",{key:t._id,className:"box-border flex items-center justify-center w-full h-full border-b hover:bg-gray-200"},r.a.createElement("div",{className:"w-full px-2 py-3"},r.a.createElement("p",{className:" text-lg mb-1 text-black "},t.nombre),r.a.createElement("p",{className:" text-xs mb-1 text-gray-700 "},"N\xfamero de v\xedas: ".concat(t.nVias))),r.a.createElement("div",{className:"w-full"},r.a.createElement(f,{sb:t}))))},p=function(e){var t=e.titulo,a=e.funcion;return r.a.createElement("div",null,r.a.createElement("button",{className:"bg-green-500 text-white active:bg-green-600 font-bold uppercase text-sm px-6 py-3 rounded shadow hover:shadow-lg outline-none focus:outline-none mr-1 mb-1",type:"button",style:{transition:"all .15s ease"},onClick:function(){return a(!1)}},t))},E=function(e){var t=e.titulo,a=e.funcion;return r.a.createElement("div",null,r.a.createElement("button",{className:"text-red-500 background-transparent font-bold uppercase px-6 py-2 text-sm outline-none focus:outline-none mr-1 mb-1",type:"button",style:{transition:"all .15s ease"},onClick:function(){return a(!1)}},t))},x=function(e){var t=e.setShowModal,a=e.subsectores,c=e.sector;return r.a.createElement(n.Fragment,null,r.a.createElement("div",{className:"justify-center items-center flex overflow-x-hidden overflow-y-auto fixed inset-0 z-50 outline-none focus:outline-none"},r.a.createElement("div",{className:"relative w-screen  max-h-screen md:max-w-2xl my-4 mx-auto "},r.a.createElement("div",{className:"rounded-t bg-gray-500 w-full h-full p-2 text-white flex items-center  justify-start "},r.a.createElement("h1",{className:"text-xl font-bold"},c)),r.a.createElement("div",{className:"border-0 flex flex-col w-full h-full bg-white outline-none focus:outline-none rounded-b"},r.a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3  grid-flow-row-dense p-3 overflow-x-hidden"},a&&a.map((function(e){return r.a.createElement(b,{key:e._id,sb:e})}))),r.a.createElement("div",{className:"flex items-center justify-end p-3 rounded-b"},r.a.createElement(E,{titulo:"Cerrar",funcion:function(){return t(!1)}}),r.a.createElement(p,{titulo:"Guardar",funcion:function(){return t(!1)}}))))),r.a.createElement("div",{className:"opacity-25 fixed inset-0 z-40 bg-black"}))},g=function(e){var t=e.contador,a=e.loading;return r.a.createElement("div",{id:"",className:" flex items-center justify-center px-3"},r.a.createElement("div",{className:" inline-block flex justify-center items-center rounded w-12 px-3 focus:outline-none ' \n       ".concat(0!==t&&t?"bg-blue-500 text-white":"bg-blue-200 text-gray-500","\n         ")},r.a.createElement("h5",{className:""},a?0:t),r.a.createElement("i",{className:"fas fa-ghost ml-1"})))},O=function(){return r.a.createElement("div",{className:"lds-ripple"},r.a.createElement("div",null),r.a.createElement("div",null))},v=function(e){var t,a=e.sector,c=a.nombre,o=a.subsectores,l=Object(n.useState)(!1),s=Object(i.a)(l,2),u=s[0],d=s[1],f=Object(n.useContext)(m),b=f.contadorSector,p=f.loading;b&&(t=b.filter((function(e){return e._id.sector===a._id}))[0].contador);return r.a.createElement(n.Fragment,null,r.a.createElement("button",{onClick:function(){return d(!0)},className:"inline-block flex justify-between  items-stretch md:items-center rounded shadow-lg m-3 md:w-64 bg-gray-300 focus:outline-none"},r.a.createElement("div",{className:"inline-block p-3  text-2xl"},c),r.a.createElement("div",{className:"flex mr-3"},p?r.a.createElement(O,null):r.a.createElement(g,{contador:t,loading:p}))),u?r.a.createElement("div",{className:"flex"},r.a.createElement(x,{setShowModal:function(){return d()},subsectores:o,sector:c})):null)},y=function(e){var t=e.zona,a=t.comuna,n=t.sector;return r.a.createElement("div",{className:"box-border border-2 rounded border-gray-400 m-3 w-full md:w-auto h-auto"},r.a.createElement("div",{className:"p-1 mx-1"},r.a.createElement("h1",{className:"text-2xl"},a),r.a.createElement("h3",{className:"text-lg self-end mb-1"},n&&n[0].region)),r.a.createElement("div",{className:"flex flex-col w-auto"},n&&n.map((function(e){return r.a.createElement(v,{key:e.id,sector:e})}))))},h=a(69),N=a.n(h),j=function(){return r.a.createElement("div",{className:"flex justify-center w-screen"},r.a.createElement("img",{src:N.a,alt:"Loading...",style:{width:"500px",margin:"auto",display:"block"}}))},w=function(){var e=Object(n.useContext)(d),t=e.zonas,a=e.getZonas,c=e.loading,o=Object(n.useContext)(m),l=o.getContadores,s=o.getContadorSector,i=o.contadores,u=o.addContadores;return Object(n.useEffect)((function(){a()}),[]),Object(n.useEffect)((function(){l()}),[u]),Object(n.useEffect)((function(){s(t)}),[t,i]),null===t||0!==t.length||c?r.a.createElement("div",{className:"flex flex-wrap items-baseline"},c&!t?r.a.createElement(j,null):t&&t.map((function(e){return r.a.createElement(y,{key:e.comuna,zona:e})}))):r.a.createElement("h4",null," Error ")},_=function(){return r.a.createElement(n.Fragment,null,r.a.createElement(u,null),r.a.createElement("div",{className:"flex"},r.a.createElement(w,null)),r.a.createElement("footer",{className:"bg-gray-100 h-40 "}))},C=a(7),R=a.n(C),S=a(15),k=a(14),A=a.n(k),D=a(70),T=a.n(D),G=a(28),z=a(1),Z=function(e,t){return Object.keys(t).reduce((function(a,n){return Object(z.a)(Object(z.a)({},a),Object(G.a)({},e[n]||n,t[n]))}),{})},I=function(e,t){switch(t.type){case"GET_ZONAS":return Object(z.a)(Object(z.a)({},e),{},{loading:!1,zonas:t.payload});case"LOADING_ZONAS":return Object(z.a)(Object(z.a)({},e),{},{loading:!0});case"ZONAS_ERROR":return Object(z.a)(Object(z.a)({},e),{},{loading:!1,error:t.payload});default:return e}},L=function(e){var t=Object(n.useReducer)(I,{zonas:null,loading:!1,current:null,filtered:null,error:null}),a=Object(i.a)(t,2),c=a[0],o=a[1],l=function(){o({type:"LOADING_ZONAS",payload:!0})},s=function(){var e=Object(S.a)(R.a.mark((function e(){var t,a;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,l(),e.next=4,A.a.get("/api/v1/sectores");case 4:t=e.sent,a=t.data.data,a=Object.entries(T()(a,"comuna")).map((function(e){return Z({0:"comuna",1:"sector"},e)})),o({type:"GET_ZONAS",payload:a}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),o({type:"ZONAS_ERROR",payload:e.t0.response});case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(d.Provider,{value:{zonas:c.zonas,loading:c.loading,current:c.current,filtered:c.filtered,error:c.error,getZonas:s,loadingZonas:l}},e.children)},P=a(71),F=function(e,t){switch(t.type){case"LOADING_CONTADORES":return Object(z.a)(Object(z.a)({},e),{},{loading:!0});case"GET_CONTADORES":return Object(z.a)(Object(z.a)({},e),{},{contadores:t.payload,loading:!1});case"GET_CONTADORES_SECTOR":return Object(z.a)(Object(z.a)({},e),{},{contadorSector:t.payload,loading:!1});case"UPDATE_CONTADORES":return Object(z.a)(Object(z.a)({},e),{},{contadores:e.contadores.map((function(e){return e._id===t.payload._id?t.payload:e})),loading:!1});case"ADD_CONTADORES":return Object(z.a)(Object(z.a)({},e),{},{contadores:[].concat(Object(P.a)(e.contadores),[t.payload])});case"ERROR_CONTADORES":return Object(z.a)(Object(z.a)({},e),{},{loading:!1,error:t.payload});default:return e}},M=function(e){var t=Object(n.useReducer)(F,{contadores:null,contadorSector:null,loading:!1,error:null}),a=Object(i.a)(t,2),c=a[0],o=a[1],l=function(){o({type:"LOADING_CONTADORES",payload:!0})},s=function(){var e=Object(S.a)(R.a.mark((function e(){var t,a;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,l(),e.next=4,A.a.get("/api/v1/contadores");case 4:t=e.sent,a=t.data.data,o({type:"GET_CONTADORES",payload:a}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),o({type:"ERROR_CONTADORES",payload:e.t0.response});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),u=function(){var e=Object(S.a)(R.a.mark((function e(t){return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.delegateYield(R.a.mark((function e(){var a,n,r,c,s;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(l(),a=t.map((function(e){return e.sector})),n=[],r=0;r<a.length;r++)a[r].map((function(e){return n.push(e._id)}));return e.next=6,Promise.all(n.map((function(e){return A.a.get("/api/v1/sectores/".concat(e,"/contadores"))})));case 6:c=e.sent,s=c.map((function(e){return e.data.data})),o({type:"GET_CONTADORES_SECTOR",payload:s});case 9:case"end":return e.stop()}}),e)}))(),"t0",2);case 2:e.next=7;break;case 4:e.prev=4,e.t1=e.catch(0),o({type:"ERROR_CONTADORES",payload:e.t1.response});case 7:case"end":return e.stop()}}),e,null,[[0,4]])})));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=Object(S.a)(R.a.mark((function e(t,a){var n,r,c;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n={headers:{"Content-Type":"application/json"}},a){e.next=14;break}return e.prev=2,e.next=5,A.a.post("/api/v1/subsectores/".concat(t.subsector._id,"/contadores/"),t,n);case 5:r=e.sent,o({type:"ADD_CONTADORES",payload:r.data.data}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),o({type:"ERROR_CONTADORES",payload:e.t0.response.msg});case 12:e.next=24;break;case 14:return e.prev=14,e.next=17,A.a.put("/api/v1/contadores/".concat(a),t,n);case 17:c=e.sent,o({type:"UPDATE_CONTADORES",payload:c.data.data}),e.next=24;break;case 21:e.prev=21,e.t1=e.catch(14),o({type:"ERROR_CONTADORES",payload:e.t1.response.msg});case 24:case"end":return e.stop()}}),e,null,[[2,9],[14,21]])})));return function(t,a){return e.apply(this,arguments)}}();return r.a.createElement(m.Provider,{value:{contadores:c.contadores,contadorSector:c.contadorSector,loading:c.loading,error:c.error,getContadores:s,loadingContadores:l,getContadorSector:u,addContador:d,setThisContador:function(e){if(c.contadores){var t=c.contadores.filter((function(t){return t.subsector._id===e||t.subsector===e}));return 0===t.length&&(t=[{subsector:{_id:e},fecha:Date.now(),contador:0,dbStatus:401}]),t[0]}}}},e.children)};var J=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(L,null,r.a.createElement(M,null,r.a.createElement(l.a,null,r.a.createElement(n.Fragment,null,r.a.createElement(s.a,{exact:!0,path:"/",component:_}))))))};o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(J,null)),document.getElementById("root"))},69:function(e,t,a){e.exports=a.p+"static/media/loading.23968a8d.gif"},72:function(e,t,a){e.exports=a(190)},77:function(e,t,a){}},[[72,1,2]]]);
//# sourceMappingURL=main.8fb4337e.chunk.js.map